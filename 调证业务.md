### 详情页-流转

**动态 step list 的要求：**
每次流转相关的接口，需要信息：  
1.完结时间 timeText  
2.更新进度节点 stepList  
3.当前节点的状态 stageData  
4.工单 id id

**使用 redux 取消异步**
【bug 描述】：  
在工单 A 页面，发出了自动流转的异步 action,然后切换到工单 B 页面。
此时之前的异步 action 结束，触发流转：但这个流转是工单 A 的流转。  
【解决方案】：  
方案一：  
在页面卸载时，取消流转的异步请求。  
https://redux-toolkit-cn.netlify.app/api/createasyncthunk/

方案二：  
绑定页面 ID (即数据的 ID), 对于异步的响应加上数据 ID，如果异步的数据 ID 和当前状态的 ID 不一致，则不更新状态。

### 详情页-录入表单

场景  
1.数组动态表单。  
2.在数组动态表单中，数组的每项中是一个子表单，内部有前后表单项的依赖关系。  
比如 radio 切换，下面的一些 radio/input/select 有不同的展示（动态）。  
监听 onChange 用 setFieldValue 来联动； 动态渲染？

Form 下面的 children 是一个函数，可以消费 formState; 也可以通过 useFormApi 获取 field 的 value 来进行动态渲染。 (semi-ui)

Form.Item 下面的 children 是一个函数，可以消费 getFieldValue, Form.Item 可以嵌套，外层的 Form.Item 仅起到可消费 getFieldValue。 (antd)

3.复用表单，在不同的情况下，表单的有些字段展示是不一样的。
解决方案：使用一个 Context 来提供变量控制。

## 简历

技术栈：TS + React + Redux + Semi-ui + emotion/css
项目内容：
调证平台重构，负责前端项目的重写。

1. 前端项目搭建和页面还原，定期发布测试环境进行 UI 验收。
2. 业务组件（如复用工单表单）、通用组件的封装（如鉴权组件和流程节点组件），第三方组件 KeepAlive 的引入等。
3. 一期项目可以分为三大部分：工单创建、工单查询和工单流转。其中工单流转是重点：
   3.1 对不同工单有不同的流转节点；
   3.2 分 4 个用户组，每个用户组有不同的权限，在工单不同的节点，有不同的操作权限，实现按钮级别的权限控制。
   3.3 一些节点存在需求录入，涉及动态表单和数据预览。一些节点则存在查询任务，通过轮询任务状态判断该节点是否完成。

项目难点：  
1.工单的节点流转。
为了流转逻辑的高可维护性，采用了 redux 对工单流转页进行了状态管理。借助 redux-toolkit 减少样板模板同时支撑起异步 action 逻辑。 并解决相关问题：一个工单流转页到另一个工单流转页，异步 action 没有取消可能导致状态更新错误。

2.鉴权组件开发，支撑路由和按钮级别的权限控制。
参考了 umijs 的 plugin-access 插件 API，实现了鉴权组件。组件 AccessGuard 通过认证接口和鉴权接口生成权限表，动态生成路由。提供 Access 组件和 useAccess hook, 支持按钮级别的权限控制。

---

### 删减版

技术栈：TS + React + Redux + Semi-ui + emotion/css
项目内容：
调证平台重构，负责前端项目的重写。

1. 前端项目搭建和页面还原，定期进行 UI 验收。
2. 业务组件（如复用工单表单）、通用组件的封装（如鉴权组件和流程节点组件），第三方组件 KeepAlive 的引入等。
3. 一期项目可以分为三大部分：工单创建、工单查询和工单流转。其中工单流转是重点：
   3.1 对不同工单有不同的流转节点组；
   3.2 分四个用户组，在工单不同的节点，用户组有不同的操作权限，做到按钮级别的权限控制。
   3.3 节点存在操作：需求录入（涉及动态表单和数据预览），查询任务（通过轮询任务状态判断该节点是否完成）。

项目难点：  
1.工单的节点流转。为了流转逻辑的高可维护性，采用了 redux 对工单流转页进行了状态管理。  
2.鉴权组件开发，支撑路由和按钮级别的权限控制。

--
